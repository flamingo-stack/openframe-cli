<!-- source-hash: 65557cee0a7eedb13cd2596556ffe292 -->
This file contains comprehensive unit tests for the k3d cluster node discovery functionality within the cluster service package. It validates the ability to find, filter, and identify k3d worker nodes in Docker containers.

## Key Components

- **TestClusterService_getK3dClusterNodes**: Tests the main node discovery method with various scenarios including empty cluster names, failed commands, and successful discovery
- **TestClusterService_filterK3dNodes**: Tests the filtering logic that extracts valid k3d nodes from Docker output
- **TestClusterService_isK3dWorkerNode**: Tests the validation logic for identifying legitimate worker nodes (servers/agents) vs infrastructure containers
- **TestClusterService_cleanupDockerResources_Integration**: Integration test verifying the complete cleanup flow

## Usage Example

```go
// Run all tests
go test ./internal/cluster -v

// Run specific test
go test -run TestClusterService_getK3dClusterNodes ./internal/cluster

// Test with mock executor setup
mockExec := executor.NewMockCommandExecutor()
mockExec.SetResponse("docker ps", &executor.CommandResult{
    Stdout: "k3d-test-cluster-server-0\nk3d-test-cluster-agent-0",
})
service := NewClusterService(mockExec)
nodes, err := service.getK3dClusterNodes(context.Background(), "test-cluster")
```

The tests use the testify framework for assertions and mock the command executor to simulate various Docker command scenarios without requiring actual Docker containers.