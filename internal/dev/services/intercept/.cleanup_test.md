<!-- source-hash: 75bc2a38056eaf2ec7ff2832293b1ca8 -->
This file contains comprehensive unit tests for the cleanup and signal handling functionality of the intercept service. It verifies that Telepresence connections are properly terminated and original namespace context is restored when the service is interrupted or shut down.

## Key Components

- **TestService_SetupCleanupHandler**: Tests signal channel initialization and configuration
- **TestService_Cleanup**: Extensive test suite covering various cleanup scenarios including failures and edge cases
- **TestSignalHandling**: Verifies proper handling of SIGINT and SIGTERM signals
- **TestCleanupState_Management**: Tests internal state management during intercept lifecycle

## Usage Example

```go
// Test cleanup behavior when intercept is active
func TestCleanupExample(t *testing.T) {
    mockExecutor := testutil.NewTestMockExecutor()
    service := NewService(mockExecutor, false)
    
    // Setup intercept state
    service.isIntercepting = true
    service.currentService = "api-service"
    service.currentNamespace = "production"
    service.originalNamespace = "default"
    
    // Configure expected commands
    mockExecutor.SetResponse("telepresence leave", &executor.CommandResult{ExitCode: 0})
    mockExecutor.SetResponse("telepresence quit", &executor.CommandResult{ExitCode: 0})
    mockExecutor.SetResponse("telepresence connect", &executor.CommandResult{ExitCode: 0})
    
    // Verify cleanup commands are executed
    assert.True(t, mockExecutor.WasCommandExecuted("telepresence leave"))
    assert.True(t, mockExecutor.WasCommandExecuted("telepresence quit"))
}
```