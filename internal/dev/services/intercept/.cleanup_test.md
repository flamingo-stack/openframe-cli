<!-- source-hash: 75bc2a38056eaf2ec7ff2832293b1ca8 -->
This file contains comprehensive unit tests for the cleanup functionality of the intercept service, specifically testing signal handling and cleanup processes for Telepresence connections.

## Key Components

- **TestService_SetupCleanupHandler**: Tests the initialization of signal handling for graceful cleanup
- **TestService_Cleanup**: Comprehensive test suite covering various cleanup scenarios including failures and different namespace configurations
- **TestSignalHandling**: Tests SIGINT and SIGTERM signal handling capabilities
- **TestCleanupState_Management**: Tests state management throughout the intercept lifecycle

## Usage Example

```go
// Running a specific test
func TestCleanup(t *testing.T) {
    testutil.InitializeTestMode()
    mockExecutor := testutil.NewTestMockExecutor()
    service := NewService(mockExecutor, false)
    
    // Setup test state
    service.isIntercepting = true
    service.currentService = "api-service"
    service.originalNamespace = "default"
    
    // Configure mock responses
    mockExecutor.SetResponse("telepresence leave", &executor.CommandResult{ExitCode: 0})
    mockExecutor.SetResponse("telepresence quit", &executor.CommandResult{ExitCode: 0})
    
    // Verify cleanup commands are executed
    assert.True(t, mockExecutor.WasCommandExecuted("telepresence leave"))
}
```

The tests cover edge cases like command failures, namespace restoration logic, and proper signal channel configuration without triggering actual system exits.